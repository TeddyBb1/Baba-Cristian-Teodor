<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Simulează costul proiectului — OutsourceX</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="simulator.css">
</head>

<!-- Buton „Înapoi sus” -->
<button id="backToTop" aria-label="Înapoi sus">↑</button>

<script>
  const btn = document.getElementById('backToTop');

  // afișează butonul după 300px scroll
  window.addEventListener('scroll', () => {
    if (document.documentElement.scrollTop > 300) {
      btn.classList.add('show');
    } else {
      btn.classList.remove('show');
    }
  });

  // scroll lin către top
  btn.addEventListener('click', () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });
</script>

<body>
<header class="site-header">
  <div class="container header-inner">
    <a class="logo" href="index.html">
      <span class="logo-mark"></span>
      <span class="logo-text">OutsourceX</span>
    </a>
    <nav class="nav">
      <a href="index.html">Acasă</a>
      <a href="servicii.html">Servicii</a>
      <a href="echipa.html">Echipă</a>
    </nav>
    <a class="btn btn-accent" href="#contact">Contact</a>
  </div>
</header>

<main>
  <!-- HERO -->
  <section class="hero hero--sim">
    <div class="hero-inner">
      <h1 class="hero-title">Simulează costul proiectului</h1>
      <p class="hero-sub">Alege domeniul, echipa și durata. Estimare actualizată automat.</p>
    </div>
  </section>

  <!-- GRID PRINCIPAL -->
  <section class="sim-grid">
    <div class="container sim-inner">

      <!-- CARD FORMULAR -->
      <div class="card sim-form">

        <h2>1) Date proiect</h2>
        <div class="row">
          <div class="field">
            <span>Dată start</span>
            <input type="date" id="startDate">
          </div>

          <div class="field">
            <span>Deadline</span>
            <input type="date" id="endDate">
          </div>

          <div class="field">
            <span>Complexitate</span>
            <select id="complexity">
              <option value="1.0">Standard</option>
              <option value="1.15">Mediu</option>
              <option value="1.35">Avansat</option>
            </select>
          </div>

          <div class="field">
            <span>Monedă</span>
            <select id="currency">
              <option value="EUR">EUR €</option>
              <option value="USD">USD $</option>
            </select>
          </div>
        </div>

        <h2 style="margin-top:20px;">2) Compoziția echipei</h2>
        <p class="small">Selectează persoane reale pentru proiect:</p>

        <button class="btn" id="selectTeamBtn">Selectează echipa</button>

        <div id="selectedTeam" class="chips"></div>

        <h2 style="margin-top:20px;">3) Extra opțiuni</h2>
        <div class="extras">
          <label><input type="checkbox" class="extraOpt" value="0.05"> QA Automation (+5%)</label>
          <label><input type="checkbox" class="extraOpt" value="0.07"> Observability (+7%)</label>
          <label><input type="checkbox" class="extraOpt" value="0.03"> Security Hardening (+3%)</label>
          <label><input type="checkbox" class="extraOpt" value="0.02"> Post-launch Support (+2%)</label>
        </div>

      </div>

      <!-- CARD SUMAR -->
      <div class="card summary">
        <div class="sum-head">
          <strong>Estimare</strong>
          <select id="currencyUI">
            <option value="EUR">EUR €</option>
            <option value="USD">USD $</option>
          </select>
        </div>

        <div class="sum-kpis">
          <div><span class="big" id="kpiCostLunar">€0</span><div class="small">Cost lunar</div></div>
          <div><span class="big" id="kpiLuni">0</span><div class="small">Luni</div></div>
          <div><span class="big" id="kpiTotal">€0</span><div class="small">Total proiect</div></div>
        </div>

        <hr>

        <div class="sum-break" id="costBreakdown"></div>

        <button class="btn full">Soliită ofertă completă</button>
      </div>

    </div>
  </section>
</main>

<!-- ✅ PERSON PICKER MODAL -->
<div class="picker-backdrop" id="picker" hidden>
  <div class="picker">
    <div class="picker-head">
      <strong>Selectează membrii echipei</strong>
      <button class="picker-close" id="closePicker">×</button>
    </div>

    <div class="picker-body" id="pickerBody"></div>

    <div class="picker-foot">
      <button class="btn-ghost" id="cancelPicker">Anulează</button>
      <button class="btn" id="savePicker">Salvează selecția</button>
    </div>
  </div>
</div>

<!-- ===========================
     JS DIRECT ÎN ACEST FIȘIER
     =========================== -->
<script>
/* ---------- Echipa reală: 32 membri, grupați pe 8 domenii ---------- */
const TEAM = {
  "Software Development": [
    {id:1, name:"Inginer software", cost:60},
    {id:2, name:"Backend engineer", cost:65},
    {id:3, name:"Frontend engineer", cost:55},
    {id:4, name:"Mobile developer", cost:58}
  ],
  "AI & Data Science": [
    {id:5, name:"ML Engineer", cost:70},
    {id:6, name:"Data Scientist", cost:72},
    {id:7, name:"Data Engineer", cost:68},
    {id:8, name:"Applied ML", cost:75}
  ],
  "DevOps & Cloud": [
    {id:9, name:"Cloud Engineer", cost:67},
    {id:10, name:"Platform Engineer", cost:69},
    {id:11, name:"Site Reliability", cost:70},
    {id:12, name:"SecDevOps", cost:72}
  ],
  "UI/UX Design": [
    {id:13, name:"Product Designer", cost:55},
    {id:14, name:"UI Designer", cost:50},
    {id:15, name:"Prototyper", cost:50},
    {id:16, name:"Content Designer", cost:45}
  ],
  "Marketing & Branding": [
    {id:17, name:"Growth Marketer", cost:50},
    {id:18, name:"Brand Designer", cost:48},
    {id:19, name:"Content Strategist", cost:46},
    {id:20, name:"Social Media", cost:45}
  ],
  "Embedded & IoT": [
    {id:21, name:"Embedded Engineer", cost:60},
    {id:22, name:"IoT Engineer", cost:62},
    {id:23, name:"Electronics", cost:61},
    {id:24, name:"Edge AI", cost:65}
  ],
  "Cybersecurity": [
    {id:25, name:"AppSec Engineer", cost:75},
    {id:26, name:"Blue Team", cost:70},
    {id:27, name:"Pen-Tester", cost:80},
    {id:28, name:"GRC Specialist", cost:65}
  ],
  "Legal Tech": [
    {id:29, name:"Legal Engineer", cost:60},
    {id:30, name:"Compliance Tech", cost:58},
    {id:31, name:"AI Paralegal", cost:65},
    {id:32, name:"Product Owner", cost:70}
  ]
};

let selected = [];

/* ---------- Helpers ---------- */
const fx = x => "€" + x.toLocaleString("ro-RO");

/* ---------- UI referințe ---------- */
const picker = document.getElementById("picker");
const pickerBody = document.getElementById("pickerBody");
const selectedWrap = document.getElementById("selectedTeam");
const kpiCostLunar = document.getElementById("kpiCostLunar");
const kpiLuni = document.getElementById("kpiLuni");
const kpiTotal = document.getElementById("kpiTotal");
const costBreakdown = document.getElementById("costBreakdown");

/* ---------- Deschidere/închidere picker ---------- */
document.getElementById("selectTeamBtn").addEventListener("click", () => {
  picker.hidden = false;
  renderPicker();
});
document.getElementById("closePicker").addEventListener("click", () => picker.hidden = true);
document.getElementById("cancelPicker").addEventListener("click", () => picker.hidden = true);

/* ---------- Generează grila de selecție ---------- */
function renderPicker(){
  pickerBody.innerHTML = "";
  Object.entries(TEAM).forEach(([group, members]) => {
    const h = document.createElement("h3");
    h.textContent = group;
    pickerBody.appendChild(h);

    const grid = document.createElement("div");
    grid.className = "picker-grid";

    members.forEach(m => {
      const card = document.createElement("label");
      card.className = "p-card" + (selected.includes(m.id) ? " on" : "");
      card.innerHTML = `
        <input type="checkbox" value="${m.id}" ${selected.includes(m.id) ? "checked" : ""}>
        <strong>${m.name}</strong>
        <small>€${m.cost}/h</small>
      `;
      grid.appendChild(card);
    });

    pickerBody.appendChild(grid);
  });
}

/* ---------- Salvează selecția ---------- */
document.getElementById("savePicker").addEventListener("click", () => {
  selected = [...pickerBody.querySelectorAll(".p-card input:checked")].map(x => +x.value);
  picker.hidden = true;
  renderSelected();
  updateCosts();
});

/* ---------- Afișează chips cu oamenii aleși ---------- */
function renderSelected(){
  selectedWrap.innerHTML = "";
  Object.values(TEAM).flat().filter(m => selected.includes(m.id)).forEach(m => {
    const chip = document.createElement("span");
    chip.className = "chip";
    chip.innerHTML = `<em>${m.name}</em>`;
    selectedWrap.appendChild(chip);
  });
}

/* ---------- Calcul costuri ---------- */
function updateCosts(){
  if(!selected.length){
    kpiCostLunar.textContent = "€0";
    kpiTotal.textContent = "€0";
    kpiLuni.textContent = "0";
    costBreakdown.innerHTML = "";
    return;
  }

  const start = new Date(document.getElementById("startDate").value || new Date());
  const endRaw = document.getElementById("endDate").value;
  const end = new Date(endRaw || start);
  const months = Math.max(1, (end - start) / (1000*60*60*24*30) || 1);

  const complexity = +document.getElementById("complexity").value;

  let costLunar = Object.values(TEAM).flat()
    .filter(m => selected.includes(m.id))
    .reduce((s,m) => s + m.cost*160, 0); // 160h/lună

  costLunar *= complexity;

  let uplifts = [...document.querySelectorAll(".extraOpt:checked")].reduce((a,b) => a + +b.value, 0);
  costLunar *= (1 + uplifts);

  const total = costLunar * months;

  kpiCostLunar.textContent = fx(Math.round(costLunar));
  kpiTotal.textContent   = fx(Math.round(total));
  kpiLuni.textContent    = Math.round(months);

  renderBreakdown();
}

/* ---------- Breakdown lunar ---------- */
function renderBreakdown(){
  costBreakdown.innerHTML = "";
  Object.values(TEAM).flat()
    .filter(m => selected.includes(m.id))
    .forEach(m => {
      const row = document.createElement("div");
      row.className = "br";
      row.innerHTML = `<span>${m.name}</span><span>${fx(m.cost*160)}</span>`;
      costBreakdown.appendChild(row);
    });
}

/* ---------- Event listeners pentru recalcul ---------- */
["startDate","endDate","complexity"].forEach(id => {
  document.getElementById(id).addEventListener("change", updateCosts);
});
document.querySelectorAll(".extraOpt").forEach(el => {
  el.addEventListener("change", updateCosts);
});
document.getElementById("currencyUI").addEventListener("change", updateCosts);

/* ---------- Valori implicite utile ---------- */
(function preset(){
  const today = new Date();
  const inSixMonths = new Date(today);
  inSixMonths.setMonth(inSixMonths.getMonth()+6);
  document.getElementById("startDate").value = today.toISOString().slice(0,10);
  document.getElementById("endDate").value = inSixMonths.toISOString().slice(0,10);
})();
</script>
</body>
</html>
